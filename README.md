# 概要

当ツールは暇ツール（暇士様作成）に画面認識機能や対戦記録保存・分析機能を追加したツールである
ダメージ計算やポケモン情報、各モジュールに関しては本家のものを流用している

# 使い方

## 全体

- 文字入力コンボボックスでは、途中まで入力してEnterを押すと候補が表示される
  - アルファベットでもひらがな変換される
- 非対応事項、バグは[こちらのIssue](https://github.com/urasaku77/svcalc-modified/issues/11)参照

## 対戦画面

![対戦画面](/image/readme/menu-battle.png)

※現在のバージョンよりも古いバージョンの可能性があります

## 機能説明

### パーティ

- 編集ボタン（左側）を押すと、ポケモン選択画面が表示され、手動で登録できる
- 右側のボタンを押すと、自分側はあらかじめ登録しておいたパーティのアイコンが表示され、相手側はパーティを一括クリアされる
  - 登録方法に関しては「パーティ画面」の章を参照
  - 相手のパーティに関しては基本画像認識で登録するので、「制御」の章を参照
- アイコンを押すことで、ダメージ計算を行いたいポケモンを選択できる
  - メタモンの場合は自動的に相手ポケモンをコピーする
  - 天候やフィールドを書き換える特性をもつポケモンの場合は自動的に書き換わる

### 選出

- アイコンを押すことで削除できる
- ゴミ箱のアイコンを押すことで一括削除できる
- ポケモン情報部のポケモンのアイコンをクリックすることで登録される

### 基本情報

- ダメージ計算を行うポケモンの基本情報が表示される
- ポケ徹ボタンを押すことで、そのポケモンのポケモン徹底攻略のSV図鑑を開くことができる
- フォルムは反映されない

### ポケモン情報

- 初期ステータスはポケモンの登録方法によって異なる
  - 自分の予め登録していたパーティの場合はその登録内容が反映
  - それ以外の場合は、種族値に応じた初期値が反映される
  - 例）Aが一番高く、H＞Sの場合はいじっぱりAS252、Cが一番高く、H＜Sの場合はおくびょうCS252など
- 努力値・ランクはカーソルか手動入力で設定
  - 努力値は0と252を切り替え
  - ランクは1ずつ増減
  - ゴミ箱で一括削除可能
- 個体値はA0かS0のみ可能。他はV前提
- 実数値はランク反映されてものが自動で計算され表示
- テラス、性格、持ち物、特性、壁はドロップダウンから選択。直接入力も可能。
  - 特性は一部有効/無効が切り替えられる
  - トレースは相手の特性に変更になる（一部を除く）
- 壁、やけど、急所、じゅうでん状態を考慮して計算することも可能
- フォルムチェンジがあるポケモンはボタンで変更可能
  - 現状イルカマンのみ
- アイコンを押すことで選出ポケモンに登録できる

### わざ情報

- 予め設定された技、設定されていない場合はHOME使用率TOP10の技が表示される
  - 相手側の左端には使用率が表示される
- 技の右ボタンを押すと設定を変更できる
  - ふんどのこぶしのダメージ量、つららばりの回数など
  - ランク上昇・下降技は押すことで1回使用分のランク変更ができる
  - スキルスワップ、じこあんじなどの特殊な技はその効果が反映される
- 両ポケモンが選択されているとダメージ計算結果が表示される
- その場で技を入力し、変更することも可能

### タイマー

- 20分のタイマーを設定できる
- ベース緑色だが、10分前で青色、5分前で黄色、3分前で赤色に変わる
- 基本的には画面キャプチャ機能によって自動でON/OFFが切り替わるが、手動で設定も可能

### カウンタ

- PP管理などで利用する
- タイトルをつけることも可能

### 天候&フィールド

- 天候、フィールドの状態を更新できる

### 素早さ比較

![素早さ比較](/image/readme/speed.png)

- 選択されているポケモン同士の素早さを比較することができる
- 各項目の値を変更することで瞬時に素早さを計算できる
- 自分のポケモンが素早さ補正ありの性格、スカーフ持ちの場合は自動で反映される
- ポップアップを閉じると入力内容はリセットされる（要検討）

### 重さ比較

![重さ比較](/image/readme/weight.png)

- ヘビーボンバーとヒートスタンプのダメージをポップアップで表示する
- ダメージ計算にはすでに反映されている
- 重さ情報に関しては、基本情報の欄にも表示される

### HOME情報

- 相手ポケモンの持ち物、特性、性格、テラスの使用率TOP10が表示される
- 項目をクリックすることで、ダメージ計算に反映される
- データは起動時に自動で更新されるが、メニューからや別のバッチファイルから更新できる

### 対戦メモ登録

- TN、ランク、メモを登録できる
  - 一応TNとランクは自動で登録される
  - 入力は任意
- お気に入りで登録しておくと、分析時に絞り込みが可能（未実装）
- クリアボタンを押すと両選出&相手パーティの情報がリセットされる
- 勝ち、負け、分けのいずれかを選択して対戦の各情報をDBに保存する
  - 保存時も勝手にクリアされる

### 制御

- 「websocket接続」ボタンでOBSとの接続が可能
  - OBSが起動していないとエラー
- 「キャプチャ監視」ボタンで画像認識監視
  - 選出画面で両パーティ&自分選出読み取り
  - 対戦開始時にタイマー起動
- 「選出画面キャプチャ」ボタンで両パーティ&自分選出読み取りを手動で実行
- 「類似パーティ検索」ボタンで相手パーティと一致する過去の構築記事を表示する
  - 並びまで一致しているものと、中身だけ同じものを区別して表示されます
  - 構築記事のリンクに飛ぶこともできます
  - 事前に別バッチファイルかTOPメニューからデータを取得しておく
  - 15分くらいかかります

## パーティ画面

![パーティ画面](/image/readme/party.png)

メニューの「パーティ編集」ボタンを押すと画面が切り替わる（閉じると対戦画面に戻る）

### ポケモン登録・変更

- アイコンボタンを押してダイアログからポケモンの情報を入力する
  - Top100のポケモンが表示されるので、直接選択しても良い
- それぞれの値を入力or選択
- 努力値・個体値は最大-最小の選択か直接入力
- 種族値・実数値は自動で表示
- ゴミ箱ボタンを押すと削除できる
- ノートアイコンを押すとポケモンのメモを入力できる（対戦中は確認不可）
- 矢印ボタンを押すと並び替えができる

### パーティ保存

- 番号、連番、タイトルを入力して保存する
  - 番号
    - パーティの番号
  - 連番
    - 同じ番号で一部だけ変更したバージョン数
  - ※分析時にこれらの番号で絞り込むことが可能（未実装）
- 全クリアボタンで入力した内容を一括削除できる
- 「CSV書き込み」ボタンで保存される
  - 既存のファイルは上書きされる
- 「使用するパーティに設定」にチェックを入れることで登録時に設定可能

### パーティ編集

- 「CSV読み込み」ボタンからパーティを選択して編集する

### 星取表作成

- 使用率TOPのポケモンと自分のパーティの相性表テンプレートCSVを作成する
  - 何位まで反映させるかを選択できる
  - tableフォルダにパーティの名前で保存される
    - パーティ名未設定の場合はundefined.csv

### 使用パーティ変更

- 一番右のボタンから変更可能

## 対戦履歴画面

![対戦履歴画面](/image/readme/record.png)

- 設定した期間の履歴を見ることができる
- パーティごとに絞ることも可能
- お気に入りのチェックを入れるとお気に入りのみ表示する

## 対戦分析画面

![対戦分析画面1](/image/readme/analysis.png)

![対戦分析画面2](/image/readme/analysis_detail.png)

- 設定した期間の分析を行うことができる
- デフォルトで見られる内容
  - 相手のKP、勝率
  - 対戦数と勝率
  - 直近使用したパーティ
- 番号を絞ることで見られる内容
  - 相手の選出率
  - 相手の初手選出率
- 連番を絞ることで見られる内容
  - 自分の選出率
  - 自分の初手選出率

## その他設定

### キャプチャ設定

![キャプチャ設定](/image/readme/setting_capture.png)

- OBSのWebsocket情報を記載する

### モード切り替え

![モード切り替え](/image/readme/setting_mode.png)

- 相手選出自動登録モード
  - 相手のパーティからダメージ計算を行うポケモンを選択した際に自動で選出にも登録する
- キャプチャ監視自動開始モード
  - OBSとWebsocket接続開始時に自動でキャプチャ監視を開始する
- 相手性格変更時自動努力値変更モード
  - 相手ポケモンの性格を変えた際に、どれに合わせた努力値に自動で変更する
- 類似パーティ自動検索モード
  - 相手パーティキャプチャ時に類似パーティ検索を自動で行う
- ぱにぱにツール自動起動モード
  - ぱにぱにツールの機能をONにする
  - recog\outputImgに画像が出力されるので、OBSに配置する
    - 詳細は本家参照