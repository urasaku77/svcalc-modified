#:kivy 2.1.0
#:import DB data.db.DB

<InputPopup>
    size_hint: (None, 0.9)
    width: 700

<ActivePokemonPanel>
    formchange_icon: _formchange_icon
    evs_combobox: _evs_combobox
    teras_button: _teras_button
    BoxLayout:
        padding: [5, 5, 5, 5]
        spacing: 5
        BoxLayout:
            orientation: "vertical"
            GridLayout:
                cols: 2
                rows: 4
                padding: [5,5]
                spacing:5
                size_hint_y: 2
                BoxLayout:
                    size_hint_x: 2
                    spacing:5
                    ShortLabel:
                        text: "特性"
                        size_hint_x: 0.5
                    DropDownButton:
                        id: ability
                        size_hint_x: 5
                        disabled: True
                        items: root.pokemon.abilities if root.pokemon is not None else ""
                        text: root.pokemon.ability if root.pokemon is not None else ""
                        on_select_item: root.set_ability(self.button_text)
                BoxLayout:
                    size_hint_x: 1
                    spacing:5
                    DropDownButton:
                        id: abilities_valid
                        size_hint_x: 1
                        disabled: True
                        items: root.ability_values
                        text: root.pokemon.ability_value if root.pokemon is not None else ""
                        on_select_item: root.pokemon.ability_value = self.button_text
                    Button:
                        text: "選出"
                        on_release: root.dispatch("on_click_icon")
                BoxLayout:
                    size_hint_x: 2
                    spacing:5
                    ShortLabel:
                        text: "能力"
                        size_hint_x: 0.5
                    DropDownButton:
                        id: _evs_combobox
                        text: root.pokemon.marked_status_text if root.pokemon is not None else ""
                        items: DORYOKU_PRESET.keys()
                        disabled: True
                        on_select_item: root.on_select_doryoku_preset(self.button_text)
                        size_hint_x: 5
                BoxLayout:
                    size_hint_x: 1
                    spacing:5
                    ShortLabel:
                        text: "テラス"
                        size_hint_x: 0.5
                    IconButton:
                        id: _teras_button
                        icon: root.battle_terastype_icon
                        font_size: 14
                        on_release: root.on_click_terasicon()
                        size_hint_x: 1
                BoxLayout:
                    size_hint_x: 2
                    spacing:5
                    ShortLabel:
                        text: "持物"
                        size_hint_x: 0.5
                    DropDownButton:
                        id: item
                        text: root.pokemon.item if root.pokemon is not None else ""
                        disabled: True
                        items: root.items
                        on_select_item: root.pokemon.item = self.button_text
                        size_hint_x: 5
                BoxLayout:
                    size_hint_x: 1
                    spacing:5
                    ShortLabel:
                        text: "フォーム"
                        size_hint_x: 0.5
                    IconButton:
                        id: _formchange_icon
                        icon: root.pokemon.changeable_icon if root.pokemon is not None else ""
                        on_release: root.form_change()
                        size_hint_x: 0.5
                BoxLayout:
                    size_hint_x: 2
                    spacing:5
                    ShortLabel:
                        text: "壁"
                        size_hint_x: 0.5
                    DropDownButton:
                        id: wall
                        text: "なし"
                        items: ["なし", "リフレクター", "ひかりのかべ", "オーロラベール"]
                        size_hint_x: 4
                        disabled: True
                        on_select_item: root.set_wall(self.button_text)
                    CheckBox:
                        active: root.charging
                        on_press: root.change_charging()
                        size_hint_x: 0.5
                    ShortLabel:
                        text: "充電"
                        size_hint_x: 0.5
                BoxLayout:
                    size_hint_x: 1
                    spacing:5
                    CheckBox:
                        active: root.burn
                        on_press: root.change_burn()
                        size_hint_x: 0.5
                    ShortLabel:
                        text: "やけど"
                        size_hint_x: 1
                    CheckBox:
                        active: root.critical
                        on_press: root.change_critical()
                        size_hint_x: 0.5
                    ShortLabel:
                        text: "急所"
                        size_hint_x: 1
            GridLayout:
                rows: 1
                spacing: 5
                size_hint_y: 1
                BoxLayout:
                    orientation:'vertical'
                    size_hint_x: 1
                    size_hint_y: 1.5
                    ShortLabel:
                        text: "ランク"
                    Button:
                        text: "クリア"
                        on_release: root.change_rank()
                BoxLayout:
                    size_hint_x: 7
                    size_hint_y: 1.5
                    BoxLayout:
                        BoxLayout:
                            size_hint_x: 2
                            orientation: 'vertical'
                            ShortLabel:
                                text: "A"
                                size_hint_y: 1
                            ShortLabel:
                                id: A
                                text:str(root.pokemon.rank.A) if root.pokemon is not None else "0"
                                size_hint_y: 2
                                font_size: self.height*0.5
                        BoxLayout:
                            orientation: 'vertical'
                            size_hint_x: 1
                            Button:
                                text:"+"
                                on_release: root.change_rank("A", True)
                                size_hint_x: 1
                            Button:
                                text:"-"
                                on_release: root.change_rank("A", False)
                                size_hint_x: 1
                    BoxLayout:
                        BoxLayout:
                            size_hint_x: 2
                            orientation: 'vertical'
                            ShortLabel:
                                text: "B"
                                size_hint_y: 1
                            ShortLabel:
                                id: B
                                text:str(root.pokemon.rank.B) if root.pokemon is not None else "0"
                                size_hint_y: 2
                                font_size: self.height*0.5
                        BoxLayout:
                            orientation: 'vertical'
                            size_hint_x: 1
                            Button:
                                text:"+"
                                on_release: root.change_rank("B", True)
                                size_hint_x: 1
                            Button:
                                text:"-"
                                on_release: root.change_rank("B", False)
                                size_hint_x: 1
                    BoxLayout:
                        BoxLayout:
                            size_hint_x: 2
                            orientation: 'vertical'
                            ShortLabel:
                                text: "C"
                                size_hint_y: 1
                            ShortLabel:
                                id: C
                                text:str(root.pokemon.rank.C) if root.pokemon is not None else "0"
                                size_hint_y: 2
                                font_size: self.height*0.5
                        BoxLayout:
                            orientation: 'vertical'
                            size_hint_x: 1
                            Button:
                                text:"+"
                                on_release: root.change_rank("C", True)
                                size_hint_x: 1
                            Button:
                                text:"-"
                                on_release: root.change_rank("C", False)
                                size_hint_x: 1
                    BoxLayout:
                        BoxLayout:
                            size_hint_x: 2
                            orientation: 'vertical'
                            ShortLabel:
                                text: "D"
                                size_hint_y: 1
                            ShortLabel:
                                id: D
                                text:str(root.pokemon.rank.D) if root.pokemon is not None else "0"
                                size_hint_y: 2
                                font_size: self.height*0.5
                        BoxLayout:
                            orientation: 'vertical'
                            size_hint_x: 1
                            Button:
                                text:"+"
                                on_release: root.change_rank("D", True)
                                size_hint_x: 1
                            Button:
                                text:"-"
                                on_release: root.change_rank("D", False)
                                size_hint_x: 1
                    BoxLayout:
                        BoxLayout:
                            size_hint_x: 2
                            orientation: 'vertical'
                            ShortLabel:
                                text: "S"
                                size_hint_y: 1
                            ShortLabel:
                                id: S
                                text:str(root.pokemon.rank.S) if root.pokemon is not None else "0"
                                size_hint_y: 2
                                font_size: self.height*0.5
                        BoxLayout:
                            orientation: 'vertical'
                            size_hint_x: 1
                            Button:
                                text:"+"
                                on_release: root.change_rank("S", True)
                                size_hint_x: 1
                            Button:
                                text:"-"
                                on_release: root.change_rank("S", False)
                                size_hint_x: 1

<ShortLabel@Label>
    size_hint_x: None
    width: 60
    font_size: dp(12)

<ColorLabel>
    canvas.before:
        Color:
            rgba: self.back_color
        Rectangle:
            pos: self.pos
            size: self.size

<MyButton>
    canvas.before:
        Color:
            rgba: (1, 1, 1, 1)
        Line:
            rounded_rectangle: [*self.pos, *self.size, 5, ]
            width: 1
        Color:
            rgba: self.back_color_down if self.state=='down' else self.back_color
        RoundedRectangle:
            size: [self.width - 2, self.height - 2]
            pos: [self.x + 1, self.y + 1]
            radius: [5]

<IconButton>
    AnchorLayout:
        anchor_x: "center"
        anchor_y: "center"
        size_hint_x: None
        width: root.height if len(root.icon) > 0 else 0
        padding: [5] if len(root.icon) > 0 else [0]
        Image:
            allow_stretch: True
            source: root.icon
    Label:
        text: root.button_text
        font_size: root.font_size
        markup: True

<IconToggleButton>
    padding: [0, 0, 0, 2]
    Image:
        allow_stretch: True
        source: root.icon

<HpBarPanel>
    orientation: "vertical"
    spacing: 10
    padding: [0,10]
    BoxLayout:
        Label:
            id: damage_label
            text: root.damage_text
        Label:
            id: damage_per_label
            font_size: int(damage_label.font_size * .75)
            text: root.damage_per_text
    BoxLayout:
        size_hint_y: None
        height: root.hp_bar_height
        ColorLabel:
            id: hp_bar_1
            size_hint_x: .0000001
        ColorLabel:
            id: hp_bar_2
            size_hint_x: .0000001
        ColorLabel:
            id: hp_bar_3
            size_hint_x: 1

<WazaButton>
    WazaNameComboEdit:
        id: comboedit
        disabled: True
        size_hint: (None, None)
        size: root.size if self.disabled == False else (0, 0)
        opacity: 1 if self.disabled == False else 0
        on_focus: root.focus_comboedit(self.focus)
        on_confirm: root.waza_confirm(self.text)
    LabelButton:
        id: button
        size: root.size
        disabled: False
        size_hint: (None, None)
        size: root.size if self.disabled == False else (0, 0)
        opacity: 1 if self.disabled == False else 0
        on_release: root.click()

<PartyChooserPopupContent>
    orientation: "vertical"
    FileChooserListView:
        path: 'party'
        id: filechooser
    SimpleButton:
        text: "submit"
        on_release: root.submit(filechooser.selection)