#:kivy 2.1.0
#:import Pokemon pokedata.pokemon.Pokemon
#:import DORYOKU_PRESET pokedata.const.DORYOKU_PRESET
#:import * gui
#:include gui.kv
#:import * gui_battle
#:include gui_battle.kv
#:include kivy_gui/popup.kv

<PageBattleWidget>
    cameraPreview: camera_preview
    partyPanels: [party1, party2]
    activePokemonPanels: [_playerActivePokemon, _opponentActivePokemon]
    playerChosenPokemonPanel:_playerChosenPokemon
    opponentChosenPokemonPanels:[_opponentFirstChosenPokemon, _opponentSecondChosenPokemon, _opponentThirdChosenPokemon]
    wazaListPanels: [_playerWazaList, _opponentWazaList]
    trainerInfoPanels: [_playerInfo, _opponentInfo]
    pokemonInfoPanels: [_playerPokemonInfo, _opponentPokemonInfo]
    homeInfoPanels: [_motimono, _tarastype]
    timerLabel: _time
    BoxLayout:
        padding: [5, 5]
        pacing: 5
        BoxLayout:
            orientation:"vertical"
            size_hint_x: 1
            BoxLayout:
                orientation:"vertical"
                size_hint_y: 4
                BoxLayout:
                    size_hint_y: None
                    PartyIconPanel:
                        id: party1
                        size_hint_x: 9
                        on_select: root.select_party_pokemon(0, self.selected_index)
                    BoxLayout:
                        orientation: "vertical"
                        size_hint_x: 1
                        padding: [5, 0]
                        SimpleButton:
                            text: "登録"
                            on_release: root.load_party()
                        SimpleButton:
                            text: "読取"
                            on_release: root.recognize_before_battle()
                ActivePokemonPanel:
                    id: _playerActivePokemon
                    player: 0
                    size_hint_y: None
                    height: 160
                GridLayout:
                    cols:2
                    padding: [0, 5]
                    AnchorLayout:
                        anchor_x:"center"
                        size_hint_x: 0.1
                        PlayerChosenPokemonPanel:
                            id:_playerChosenPokemon
                    WazaListPanel:
                        id: _playerWazaList
            PokemonInfoPanel:
                id:_playerPokemonInfo
                size_hint_x: 1
                size_hint_y: 1
            TrainerInfoPanel:
                id: _playerInfo
                size_hint_y: 1.5
        BoxLayout:
            orientation:"vertical"
            size_hint_x: 2
            CameraPreview:
                id: camera_preview
                size_hint_y: 2
            BoxLayout:
                size_hint_y: 1
                HomeInfoPanel:
                    id: _motimono
                    title_name: "もちもの"
                    size_hint_x: 1
                BoxLayout:
                    orientation:"vertical"
                    size_hint_x: 1.2
                    GridLayout:
                        cols:2
                        padding: [0, 5]
                        size_hint_y: 1
                        ShortLabel:
                            text: "天候"
                        ShortLabel:
                            text: "フィールド"
                        DropDownButton:
                            text: ""
                            items: ["なし", "晴れ", "雨", "砂嵐", "雪"]
                            on_select_item: root.set_weather(self.button_text)
                        DropDownButton:
                            text: ""
                            items: ["なし","エレキ", "サイコ", "グラス", "ミスト"]
                            on_select_item: root.set_field(self.button_text)
                    BoxLayout:
                        size_hint_y: 2.5
                        BoxLayout:
                            orientation: "vertical"
                            padding:[5,5,5,0]
                            spacing:25
                            size_hint_x: 0.4
                            BoxLayout:
                                size_hint_y: 1
                                Label:
                                    text: "カメラID"
                                    size_hint_x: 0.6
                                TextInput:
                                    id: camera_id
                                    size_hint_x: 0.4
                                    text: str(root.cameraId)
                                    multiline: False
                                    font_size: self.height*0.5
                            BoxLayout:
                                size_hint_y: 0.5
                                CheckBox:
                                    group: 'radio'
                                    on_press: root.change_result(self, 1)
                                Label:
                                    text: "勝ち"
                                CheckBox:
                                    group: 'radio'
                                    on_press: root.change_result(self, 0)
                                Label:
                                    text: "負け"
                            BoxLayout:
                                height: 50
                                size_hint_y: 1
                                Button:
                                    text: "登録"
                                    on_release: root.record_battle()
                                Button:
                                    text: "クリア"
                                    on_release: root.init_battle()
                        BoxLayout:
                            orientation: "vertical"
                            size_hint_x: 0.6
                            BoxLayout:
                                size_hint_y: 1
                                Button:
                                    text: "開始/切替"
                                    on_release: root.set_camera()
                                Button:
                                    text: "素早さ比較"
                                    on_release: root.set_speed_check()
                            TimerLabel:
                                id: _time
                                size_hint_y: 3
                                height: 120
                HomeInfoPanel:
                    id: _tarastype
                    title_name: "テラスタイプ"
                    size_hint_x: 1
            BoxLayout:
                size_hint_y: 1
                OpponentChosenPokemonPanel:
                    id: _opponentFirstChosenPokemon
                    num: "①"
                OpponentChosenPokemonPanel:
                    id: _opponentSecondChosenPokemon
                    num: "②"
                OpponentChosenPokemonPanel:
                    id: _opponentThirdChosenPokemon
                    num: "③"
        BoxLayout:
            orientation:"vertical"
            size_hint_x: 1
            BoxLayout:
                orientation:"vertical"
                size_hint_y: 4
                BoxLayout:
                    size_hint_y: None
                    pacing: 5
                    PartyIconPanel:
                        id: party2
                        size_hint_x: 9
                        on_select: root.select_party_pokemon(1, self.selected_index)
                    BoxLayout:
                        orientation: "vertical"
                        size_hint_x: 1
                        padding: [5, 0]
                        SimpleButton:
                            text: "編集"
                            on_release: root.edit_party(1)
                        SimpleButton:
                            text: "削除"
                            on_release: root.clear_party(1)
                ActivePokemonPanel:
                    id: _opponentActivePokemon
                    player: 1
                    size_hint_y: None
                    height: 160
                GridLayout:
                    cols:2
                    padding: [0, 5]
                    BoxLayout:
                        orientation: "vertical"
                        size_hint_x: 0.1
                        Button:
                            height: 40
                            text: root.wazaRateList[0]
                            on_release: root.set_opponent_waza(0)
                        Button:
                            height: 40
                            text: root.wazaRateList[1]
                            on_release: root.set_opponent_waza(1)
                        Button:
                            height: 40
                            text: root.wazaRateList[2]
                            on_release: root.set_opponent_waza(2)
                        Button:
                            height: 40
                            text: root.wazaRateList[3]
                            on_release: root.set_opponent_waza(3)
                        Button:
                            height: 40
                            text: root.wazaRateList[4]
                            on_release: root.set_opponent_waza(4)
                        Button:
                            height: 40
                            text: root.wazaRateList[5]
                            on_release: root.set_opponent_waza(5)
                        Button:
                            height: 40
                            text: root.wazaRateList[6]
                            on_release: root.set_opponent_waza(6)
                        Button:
                            height: 40
                            text: root.wazaRateList[7]
                            on_release: root.set_opponent_waza(7)
                        Button:
                            height: 40
                            text: root.wazaRateList[8]
                            on_release: root.set_opponent_waza(8)
                        Button:
                            height: 40
                            text: root.wazaRateList[9]
                            on_release: root.set_opponent_waza(9)
                    WazaListPanel:
                        size_hint_x: 1
                        id: _opponentWazaList
            PokemonInfoPanel:
                id:_opponentPokemonInfo
                size_hint_x: 1
                size_hint_y: 1
            TrainerInfoPanel:
                id: _opponentInfo
                size_hint_y: 1.5
<SimpleButton@Button>
    size_hint_x: None
    width: 40
    font_size: 12